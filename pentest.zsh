function ntlm_hash {
    printf '%s' "$1" | iconv -t utf16le | openssl md4 | cut -d ' ' -f 2
}

function nmap_web_fast {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -n -Pn -sSV --top-ports 1000 --version-intensity=3 --script http-headers,http-title,http-methods,http-favicon --script-args="http.useragent=Nmap/1.0"  "$@"
}

function nmap_web_full {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -Pn -sSV -p- --script http-headers,http-title,http-methods,http-enum,http-cookie-flags,http-cors,http-cross-domain-policy,http-backup-finder,http-devframework,http-errors,http-favicon,http-git,http-internal-ip-disclosure,http-robots.txt,http-security-headers,http-server-header,http-svn-info,http-svn-enum,http-traceroute,http-useragent-tester,http-vhosts,http-waf-detect,http-waf-fingerprint,http-webdav-scan,ssl-cert,ssl-cert-intaddr,ssl-dh-params,ssl-enum-ciphers,ssl-heartbleed,sslv2,tls-alpn,tls-nextprotoneg,db2-das-info,mongodb-info,mongodb-databases,ms-sql-info,mysql-info,oracle-tns-version --script-args="http.useragent=Nmap/1.0"  "$@"
}

function nmap_lan_custom {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -n -sSUV -T4 -pT:7,21,22,23,25,53,66,79,80,81,82,88,111,137-139,389,443,445,457,512,513,514,554,631,873,1080,1098,1099,1100,1128,1241,1311,1352,1433,1434,1521-1530,1583,1944,2049,2100,2301,2375,2376,2381,3000,3050,3128,3200,3201,3203,3204,3205,3299,3306,3307,3351,3389,3632,4000,4001,4002,4100,4443,4848,4949,5000,5050,5060,5432,5433,5555,5666,5800,5801,5802,5900,6000-6009,6060,6061,6112,6129,6346,6347,6379,7001,7002,7443,7444,8000,8006,8009,8080-8090,8443,8471,8500,8834,8880,8888,8889,9060,9080,9081,9090,9091,9200,9300,9443,9471,10000,10250,10255,11211,12174,19200,30821,38292,50000,50013,50100,51443,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 --script "(default or discovery) and safe and not broadcast" "$@"
}

function nmap_lan_custom_noscript {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -n -sSUV -T4 -pT:7,21,22,23,25,53,66,79,80,81,82,88,111,137-139,389,443,445,457,512,513,514,554,631,873,1080,1098,1099,1100,1128,1241,1311,1352,1433,1434,1521-1530,1583,1944,2049,2100,2301,2375,2376,2381,3000,3050,3128,3200,3201,3203,3204,3205,3299,3306,3307,3351,3389,3632,4000,4001,4002,4100,4443,4848,4949,5000,5050,5060,5432,5433,5555,5666,5800,5801,5802,5900,6000-6009,6060,6061,6112,6129,6346,6347,6379,7001,7002,7443,7444,8000,8006,8009,8080-8090,8443,8471,8500,8834,8880,8888,8889,9060,9080,9081,9090,9091,9200,9300,9443,9471,10000,10250,10255,11211,12174,19200,30821,38292,50000,50013,50100,51443,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 "$@"
}

function nmap_lan_custom_noping {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -n -Pn -sSUV -T4 -pT:7,21,22,23,25,53,66,79,80,81,82,88,111,137-139,389,443,445,457,512,513,514,554,631,873,1080,1098,1099,1100,1128,1241,1311,1352,1433,1434,1521-1530,1583,1944,2049,2100,2301,2375,2376,2381,3000,3050,3128,3200,3201,3203,3204,3205,3299,3306,3307,3351,3389,3632,4000,4001,4002,4100,4443,4848,4949,5000,5050,5060,5432,5433,5555,5666,5800,5801,5802,5900,6000-6009,6060,6061,6112,6129,6346,6347,6379,7001,7002,7443,7444,8000,8006,8009,8080-8090,8443,8471,8500,8834,8880,8888,8889,9060,9080,9081,9090,9091,9200,9300,9443,9471,10000,10250,10255,11211,12174,19200,30821,38292,50000,50013,50100,51443,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 --script "(default or discovery) and safe and not broadcast" "$@"
}

function nmap_lan_custom_noping_noscript {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -n -Pn -sSUV -T4 -pT:7,21,22,23,25,53,66,79,80,81,82,88,111,137-139,389,443,445,457,512,513,514,554,631,873,1080,1098,1099,1100,1128,1241,1311,1352,1433,1434,1521-1530,1583,1944,2049,2100,2301,2375,2376,2381,3000,3050,3128,3200,3201,3203,3204,3205,3299,3306,3307,3351,3389,3632,4000,4001,4002,4100,4443,4848,4949,5000,5050,5060,5432,5433,5555,5666,5800,5801,5802,5900,6000-6009,6060,6061,6112,6129,6346,6347,6379,7001,7002,7443,7444,8000,8006,8009,8080-8090,8443,8471,8500,8834,8880,8888,8889,9060,9080,9081,9090,9091,9200,9300,9443,9471,10000,10250,10255,11211,12174,19200,30821,38292,50000,50013,50100,51443,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 "$@"
}

function nmap_lan_full {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -sSUV -T4 -pT:-,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 --script "(default or discovery) and safe and not broadcast" "$@"
}

function nmap_lan_full_noping {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -Pn -sSUV -T4 -pT:-,U:53,67,68,137,161,137-139,500,554,1194,1604,3478,3479,5004,5060 --script "(default or discovery) and safe and not broadcast" "$@"
}

function nmap_lan_discovery {
    sudo nmap -oA $(date +%Y-%m-%d_%H:%M:%S) -vvv --reason -sV -sn --script "(broadcast or discovery or default) and safe and not intrusive" --script-args=newtargets
}
